<div class="admin-volunteer-section">
    <div class="row">
        <div class="col-sm-4">
            <form>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search" ng-model="$ctrl.query">
                </div>
            </form>
        </div>
        <div class="col-sm-4"></div>
        <div class="col-sm-4">
             <button ng-click="ctrl.openModal()" class="btn btn-success">Add Student</button>
        </div>

    </div>
    <div class="pane">
        <table class="volunteer_table table" style="width:100%;">
            <tr>
                <td>Name</td>
                <td>Email</td>
                <td>Phone</td>
                <td>Gender</td>
                <td>Grade</td>
                <td>Community</td>
                <td>Language</td>
                <td>Date Added</td>
                <td>Classes</td>
                <td>Edit</td>
            </tr>
            <tr class="volunteer_row" ng-repeat="stud in ctrl.students | filter:$ctrl.query">

                <!-- editable form -->
                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.name}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.name"/></td>

                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.email}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.email"/></td>

                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.phone}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.phone"/></td>

                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.gender}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.gender"/></td>

                <td ng-if="stud.saved || ctrl.showStudentsEdit._id!=stud._id">{{stud.grade}}</td>
                <td ng-if="!stud.saved && ctrl.showStudentsEdit._id==stud._id">
                    <select ng-blur="ctrl.updateStudent()" class="form-control" ng-model="ctrl.showStudentsEdit.grade" ng-options="grade for grade in ctrl.grades"></select>
                </td>


                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.community}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.community"/></td>

                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.primaryLanguage}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.primaryLanguage"/></td>

                <!--End editable form -->

                <td>{{stud.createdAt | date:'MM/dd/yyyy'}}</td>
                <td><button class="btn btn-primary" ng-click="ctrl.showStudents(stud)">Show</button></td>
                <td>
                    <button ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id" class="btn btn-primary" ng-click="ctrl.openModal(stud)">Edit</button>
                    <button ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id" class="btn btn-warning" ng-click="ctrl.select(stud,true)">Save</button>
                </td>
            </tr>
        </table>

        <div ng-if="!ctrl.showAdd && ctrl.selectedStudent">
            <h3>Selected Students Classes</h3>
            <table class="table table-sm">
                <tr>
                    <th>Class Name</th>
                    <th>Student Status</th>
                    <th>Action</th>
                </tr>
                <tr ng-repeat="(key, studClass) in ctrl.addedStudents">
                    <td>{{key}}</td>
                    <td>{{studClass.status}}</td>
                    <td ng-if="studClass.status == 'Active'">
                        <button class="btn btn-warning" ng-click="ctrl.approveStudent(studClass)">Remove</button>
                    </td>
                    <td ng-if="studClass.status != 'Active'">
                        <button class="btn btn-primary" ng-click="ctrl.approveStudent(studClass)">Approve</button>
                    </td>
                </tr>
            </table>
            <h3>Not Registered Classes</h3>
            <table class="table table-sm">
                <tr>
                    <th>Class Name</th>
                    <th>Student Status</th>
                    <th>Action</th>
                </tr>
                <tr ng-repeat="(key, studClass) in ctrl.notAddedStudents">
                    <td>{{key}}</td>
                    <td>Not Registered</td>
                    <td>
                        <button class="btn btn-primary" ng-click="ctrl.registerStudent(studClass)">Register</button>
                    </td>
                </tr>
            </table>
        </div>
    <h3>Create a Student User</h3>
    <div class="col-sm-12">
      <form class="form" name="form" ng-submit="ctrl.register(form)" novalidate>
          <div hidden class="form-group" ng-class="{ 'has-success': form.name.$valid && ctrl.submitted,
                                              'has-error': form.name.$invalid && ctrl.submitted }">
                <div class="radio">
                  <label><input type="radio" name="type" value="student" ng-model="ctrl.user.type" selected>Student</label>
                </div>
         </div>
        <div class="form-group" ng-class="{ 'has-success': form.name.$valid && ctrl.submitted,
                                            'has-error': form.name.$invalid && ctrl.submitted }">
          <label>Name</label>

          <input type="text" name="name" class="form-control" ng-model="ctrl.user.name"
                 required/>
          <p class="help-block" ng-show="form.name.$error.required && ctrl.submitted">
            A name is required
          </p>
        </div>

        <div class="form-group" ng-class="{ 'has-success': form.email.$valid && ctrl.submitted,
                                            'has-error': form.email.$invalid && ctrl.submitted }">
          <label>Email</label>

          <input type="email" name="email" class="form-control" ng-model="ctrl.user.email"
                 required
                 mongoose-error/>
          <p class="help-block" ng-show="form.email.$error.required && ctrl.submitted">
            What's your email address?
          </p>
          <p class="help-block" ng-show="form.email.$error.mongoose">
            {{ ctrl.errors.email }}
          </p>
        </div>
        <div class="form-group" ng-if="ctrl.user.type=='student'">
            <label>Gender</label>

            <select ng-model="ctrl.user.gender" class="form-control">
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>

        </div>
        <div class="form-group" ng-if="ctrl.user.type=='student'">
            <label>Grade</label>
            <select ng-model="ctrl.user.grade" class="form-control">
                <option value="1">1st</option>
                <option value="2">2nd</option>
                <option value="3">3rd</option>
                <option value="4">4th</option>
                <option value="5">5th</option>
                <option value="6">6th</option>
                <option value="7">7th</option>
                <option value="8">8th</option>
                <option value="9">9th</option>
                <option value="10">10th</option>
                <option value="11">11th</option>
                <option value="12">12th</option>
            </select>

        </div>
        <div class="form-group" ng-if="ctrl.user.type=='student'">
            <label>Community</label>
            <input type="text" class="form-control" ng-model="ctrl.user.community"/>

        </div>
        <div class="form-group" ng-if="ctrl.user.type=='student'">
            <label>Primary Language</label>
            <input type="text" class="form-control" ng-model="ctrl.user.primaryLanguage"/>

        </div>
        <div class="form-group" ng-class="{ 'has-success': form.password.$valid && ctrl.submitted,
                                            'has-error': form.password.$invalid && ctrl.submitted }">
          <label>Password</label>

          <input type="password" name="password" class="form-control" ng-model="ctrl.user.password"
                 ng-minlength="3"
                 required
                 mongoose-error/>
          <p class="help-block"
             ng-show="(form.password.$error.minlength || form.password.$error.required) && ctrl.submitted">
            Password must be at least 3 characters.
          </p>
          <p class="help-block" ng-show="form.password.$error.mongoose">
            {{ ctrl.errors.password }}
          </p>
        </div>

        <div class="form-group" ng-class="{ 'has-success': form.confirmPassword.$valid && ctrl.submitted,
                                            'has-error': form.confirmPassword.$invalid && ctrl.submitted }">
          <label>Confirm Password</label>
          <input type="password" name="confirmPassword" class="form-control" ng-model="ctrl.user.confirmPassword"
                 match="ctrl.user.password"
                 ng-minlength="3" required/>
          <p class="help-block"
             ng-show="form.confirmPassword.$error.match && ctrl.submitted">
            Passwords must match.
          </p>
        </div>
        <div ng-repeat="error in ctrl.errors" style="color:red;">
            *{{error.message}}
        </div>
        <div>
          <button class="btn btn-default btn-register" type="submit">
            Add Student
          </button>
        </div>

        <hr/>
        <div ng-if="ctrl.studentAdded">{{ctrl.studentAdded}} Added</div>
      </form>
    </div>
    </div>

</div>
