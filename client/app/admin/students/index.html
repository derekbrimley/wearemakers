<div class="admin-volunteer-section">
    <form>
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search" ng-model="$ctrl.query">
      </div>
    </form>
    <div class="pane">
        <table class="volunteer_table table" style="width:100%;">
            <tr>
                <td>Name</td>
                <td>Email</td>
                <td>Phone</td>
                <td>Gender</td>
                <td>Grade</td>
                <td>Community</td>
                <td>Language</td>
                <td>Date Added</td>
                <td>Classes</td>
                <td>Edit</td>
            </tr>
            <tr class="volunteer_row" ng-repeat="stud in ctrl.students | filter:$ctrl.query">

                <!-- editable form -->
                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.name}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.name"/></td>
                
                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.email}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.email"/></td>

                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.phone}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.phone"/></td>

                <td ng-if="stud.saved==true|| ctrl.showStudentsEdit._id!=stud._id">{{stud.gender}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.gender"/></td>

                <td ng-if="stud.saved || ctrl.showStudentsEdit._id!=stud._id">{{stud.grade}}</td>
                <td ng-if="!stud.saved && ctrl.showStudentsEdit._id==stud._id">
                    <select ng-blur="ctrl.updateStudent()" class="form-control" ng-model="ctrl.showStudentsEdit.grade" ng-options="grade for grade in ctrl.grades"></select>
                </td>


                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.community}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.community"/></td>

                <td ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id">{{stud.primaryLanguage}}</td>
                <td ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id"><input ng-blur="ctrl.updateStudent()" type="text" class="form-control" ng-model="ctrl.showStudentsEdit.primaryLanguage"/></td>

                <!--End editable form -->

                <td>{{stud.createdAt | date:'MM/dd/yyyy'}}</td>
                <td><button class="btn btn-primary" ng-click="ctrl.showStudents(stud)">Show</button></td>
                <td> 
                    <button ng-if="stud.saved==true || ctrl.showStudentsEdit._id!=stud._id" class="btn btn-primary" ng-click="ctrl.select(stud,false)">Edit</button>
                    <button ng-if="stud.saved==false && ctrl.showStudentsEdit._id==stud._id" class="btn btn-warning" ng-click="ctrl.select(stud,true)">Save</button>
                </td>
            </tr>
        </table>

        <div ng-if="!ctrl.showAdd && ctrl.selectedStudent">
            <h3>Selected Students Classes</h3>
            <table class="table table-sm">
                <tr>
                    <th>Class Name</th>
                    <th>Student Status</th>
                    <th>Action</th>
                </tr>
                <tr ng-repeat="(key, studClass) in ctrl.addedStudents">
                    <td>{{key}}</td>
                    <td>{{studClass.status}}</td>
                    <td ng-if="studClass.status == 'Active'">
                        <button class="btn btn-warning" ng-click="ctrl.approveStudent(studClass)">Remove</button>
                    </td>
                    <td ng-if="studClass.status != 'Active'">
                        <button class="btn btn-primary" ng-click="ctrl.approveStudent(studClass)">Approve</button>
                    </td>
                </tr>
            </table>
            <h3>Not Registered Classes</h3>
            <table class="table table-sm">
                <tr>
                    <th>Class Name</th>
                    <th>Student Status</th>
                    <th>Action</th>
                </tr>
                <tr ng-repeat="(key, studClass) in ctrl.notAddedStudents">
                    <td>{{key}}</td>
                    <td>Not Registered</td>
                    <td>
                        <button class="btn btn-primary" ng-click="ctrl.registerStudent(studClass)">Register</button>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    
</div>